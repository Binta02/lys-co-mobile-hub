{
    "sourceFile": "send_mail.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 6,
            "patches": [
                {
                    "date": 1745916884664,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1745917067055,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,18 @@\n <?php\r\n+header(\"Access-Control-Allow-Origin: *\");\r\n+header(\"Access-Control-Allow-Headers: Content-Type\");\r\n+header(\"Access-Control-Allow-Methods: POST, OPTIONS\");\r\n+\r\n+// Si c’est une requête OPTIONS (pré-vol), on répond directement\r\n+if ($_SERVER['REQUEST_METHOD'] === 'OPTIONS') {\r\n+    http_response_code(200);\r\n+    exit();\r\n+}\r\n+\r\n error_reporting(E_ALL);\r\n ini_set('display_errors', 1);\r\n-header('Content-Type: text/plain'); // pour que le fetch lise le texte brut\r\n+header('Content-Type: text/plain');\r\n \r\n // Récupérer les données envoyées depuis le formulaire\r\n $firstName = $_POST['firstName'] ?? '';\r\n $lastName = $_POST['lastName'] ?? '';\r\n"
                },
                {
                    "date": 1745917296664,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,5 +51,7 @@\n     echo \"Headers : $headers\\n\";\r\n     echo \"Corps : $mail_body\\n\";\r\n     echo \"error\";\r\n }\r\n+file_put_contents(\"debug.txt\", \"Reçu: $mail_body\", FILE_APPEND);\r\n+\r\n ?>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1745918213341,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,50 +8,57 @@\n     http_response_code(200);\r\n     exit();\r\n }\r\n \r\n+// Affichage des erreurs\r\n error_reporting(E_ALL);\r\n ini_set('display_errors', 1);\r\n header('Content-Type: text/plain');\r\n \r\n-// Récupérer les données envoyées depuis le formulaire\r\n+// Charger PHPMailer\r\n+use PHPMailer\\PHPMailer\\PHPMailer;\r\n+use PHPMailer\\PHPMailer\\Exception;\r\n+\r\n+require 'vendor/autoload.php'; // Attention : chemin vers autoload.php de Composer\r\n+\r\n+// Récupérer les données envoyées\r\n $firstName = $_POST['firstName'] ?? '';\r\n $lastName = $_POST['lastName'] ?? '';\r\n $email = $_POST['email'] ?? '';\r\n $subject = $_POST['subject'] ?? '';\r\n $message = $_POST['message'] ?? '';\r\n-echo \"Données reçues:\\n\";\r\n-echo \"Prénom: $firstName\\n\";\r\n-echo \"Nom: $lastName\\n\";\r\n-echo \"Email: $email\\n\";\r\n-echo \"Sujet: $subject\\n\";\r\n-echo \"Message: $message\\n\\n\";\r\n \r\n-// Adresse de destination\r\n-$to = 'contact@lys-and-co.com';\r\n-\r\n-// Sujet du mail\r\n-$mail_subject = \"Nouveau message de $firstName $lastName - Sujet: $subject\";\r\n-\r\n-// Corps du mail\r\n $mail_body = \"Nom: $firstName $lastName\\n\";\r\n $mail_body .= \"Email: $email\\n\\n\";\r\n $mail_body .= \"Message:\\n$message\";\r\n \r\n-// Headers (important pour bien recevoir)\r\n-$headers = \"From: $email\\r\\n\";\r\n-$headers .= \"Reply-To: $email\\r\\n\";\r\n+// Debug fichier local (optionnel)\r\n+file_put_contents(\"debug.txt\", \"Reçu:\\n$mail_body\\n\", FILE_APPEND);\r\n \r\n-// Envoyer l'email\r\n-if (mail($to, $mail_subject, $mail_body, $headers)) {\r\n+// Préparer l'envoi avec PHPMailer\r\n+$mail = new PHPMailer(true);\r\n\\ No newline at end of file\n+\r\n+try {\r\n+    // Configuration serveur SMTP Hostinger\r\n+    $mail->isSMTP();\r\n+    $mail->Host = 'smtp.hostinger.com';\r\n+    $mail->SMTPAuth = true;\r\n+    $mail->Username = 'contact@lys-and-co.com'; // Ton adresse mail complète\r\n+    $mail->Password = 'TON_MOT_DE_PASSE'; // ⚡ Mets ici ton mot de passe d'email\r\n+    $mail->SMTPSecure = PHPMailer::ENCRYPTION_SMTPS; // SSL\r\n+    $mail->Port = 465;\r\n+\r\n+    // Expéditeur et destinataire\r\n+    $mail->setFrom($email, \"$firstName $lastName\");\r\n+    $mail->addAddress('contact@lys-and-co.com'); // Où tu veux recevoir les messages\r\n+\r\n+    // Contenu\r\n+    $mail->isHTML(false); // Texte brut\r\n+    $mail->Subject = \"Nouveau message de $firstName $lastName - Sujet: $subject\";\r\n+    $mail->Body    = $mail_body;\r\n+\r\n+    $mail->send();\r\n     echo 'success';\r\n-} else {\r\n-    echo \"Erreur lors de l'envoi du mail.\\n\";\r\n-    echo \"Sujet : $mail_subject\\n\";\r\n-    echo \"Destinataire : $to\\n\";\r\n-    echo \"Headers : $headers\\n\";\r\n-    echo \"Corps : $mail_body\\n\";\r\n-    echo \"error\";\r\n+} catch (Exception $e) {\r\n+    echo \"Erreur lors de l'envoi: {$mail->ErrorInfo}\";\r\n }\r\n-file_put_contents(\"debug.txt\", \"Reçu: $mail_body\", FILE_APPEND);\r\n-\r\n-?>\n+?>\r\n"
                },
                {
                    "date": 1745918256685,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,9 +42,9 @@\n     $mail->isSMTP();\r\n     $mail->Host = 'smtp.hostinger.com';\r\n     $mail->SMTPAuth = true;\r\n     $mail->Username = 'contact@lys-and-co.com'; // Ton adresse mail complète\r\n-    $mail->Password = 'TON_MOT_DE_PASSE'; // ⚡ Mets ici ton mot de passe d'email\r\n+    $mail->Password = 'Oceanne971-'; // ⚡ Mets ici ton mot de passe d'email\r\n     $mail->SMTPSecure = PHPMailer::ENCRYPTION_SMTPS; // SSL\r\n     $mail->Port = 465;\r\n \r\n     // Expéditeur et destinataire\r\n"
                },
                {
                    "date": 1745918451084,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,63 +2,71 @@\n header(\"Access-Control-Allow-Origin: *\");\r\n header(\"Access-Control-Allow-Headers: Content-Type\");\r\n header(\"Access-Control-Allow-Methods: POST, OPTIONS\");\r\n \r\n-// Si c’est une requête OPTIONS (pré-vol), on répond directement\r\n if ($_SERVER['REQUEST_METHOD'] === 'OPTIONS') {\r\n     http_response_code(200);\r\n     exit();\r\n }\r\n \r\n-// Affichage des erreurs\r\n error_reporting(E_ALL);\r\n ini_set('display_errors', 1);\r\n header('Content-Type: text/plain');\r\n \r\n+// Démarrer un buffer de debug\r\n+$debugLog = \"=== Nouveau test à \" . date('Y-m-d H:i:s') . \" ===\\n\";\r\n+\r\n // Charger PHPMailer\r\n use PHPMailer\\PHPMailer\\PHPMailer;\r\n use PHPMailer\\PHPMailer\\Exception;\r\n \r\n-require 'vendor/autoload.php'; // Attention : chemin vers autoload.php de Composer\r\n+require 'vendor/autoload.php'; // chemin vers Composer autoload.php\r\n \r\n // Récupérer les données envoyées\r\n $firstName = $_POST['firstName'] ?? '';\r\n $lastName = $_POST['lastName'] ?? '';\r\n $email = $_POST['email'] ?? '';\r\n $subject = $_POST['subject'] ?? '';\r\n $message = $_POST['message'] ?? '';\r\n \r\n+$debugLog .= \"Données reçues:\\nPrénom: $firstName\\nNom: $lastName\\nEmail: $email\\nSujet: $subject\\nMessage:\\n$message\\n\\n\";\r\n+\r\n $mail_body = \"Nom: $firstName $lastName\\n\";\r\n $mail_body .= \"Email: $email\\n\\n\";\r\n $mail_body .= \"Message:\\n$message\";\r\n \r\n-// Debug fichier local (optionnel)\r\n-file_put_contents(\"debug.txt\", \"Reçu:\\n$mail_body\\n\", FILE_APPEND);\r\n-\r\n-// Préparer l'envoi avec PHPMailer\r\n $mail = new PHPMailer(true);\r\n \r\n try {\r\n-    // Configuration serveur SMTP Hostinger\r\n+    // Configuration SMTP\r\n     $mail->isSMTP();\r\n     $mail->Host = 'smtp.hostinger.com';\r\n     $mail->SMTPAuth = true;\r\n-    $mail->Username = 'contact@lys-and-co.com'; // Ton adresse mail complète\r\n-    $mail->Password = 'Oceanne971-'; // ⚡ Mets ici ton mot de passe d'email\r\n-    $mail->SMTPSecure = PHPMailer::ENCRYPTION_SMTPS; // SSL\r\n+    $mail->Username = 'contact@lys-and-co.com'; // Ton email complet\r\n+    $mail->Password = 'Oceanne971-'; // ⚡ Mot de passe\r\n+    $mail->SMTPSecure = PHPMailer::ENCRYPTION_SMTPS; // SSL/TLS\r\n     $mail->Port = 465;\r\n \r\n     // Expéditeur et destinataire\r\n-    $mail->setFrom($email, \"$firstName $lastName\");\r\n-    $mail->addAddress('contact@lys-and-co.com'); // Où tu veux recevoir les messages\r\n+    $mail->setFrom('contact@lys-and-co.com', 'Site Lys & Co');\r\n+    $mail->addAddress('contact@lys-and-co.com'); // Où recevoir le mail\r\n\\ No newline at end of file\n \r\n     // Contenu\r\n-    $mail->isHTML(false); // Texte brut\r\n+    $mail->isHTML(false); \r\n     $mail->Subject = \"Nouveau message de $firstName $lastName - Sujet: $subject\";\r\n     $mail->Body = $mail_body;\r\n \r\n+    $debugLog .= \"Tentative d'envoi du mail...\\n\";\r\n+\r\n+    // Envoi\r\n     $mail->send();\r\n     echo 'success';\r\n+    $debugLog .= \"Mail envoyé avec succès.\\n\";\r\n+\r\n } catch (Exception $e) {\r\n     echo \"Erreur lors de l'envoi: {$mail->ErrorInfo}\";\r\n+    $debugLog .= \"Erreur lors de l'envoi:\\n\" . $mail->ErrorInfo . \"\\n\";\r\n }\r\n-?>\n+\r\n+// Enregistrer tout ce qui s'est passé\r\n+file_put_contents('debug.txt', $debugLog . \"\\n\\n\", FILE_APPEND);\r\n+?>\r\n"
                },
                {
                    "date": 1745918639028,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,9 +12,9 @@\n ini_set('display_errors', 1);\r\n header('Content-Type: text/plain');\r\n \r\n // Démarrer un buffer de debug\r\n-$debugLog = \"=== Nouveau test à \" . date('Y-m-d H:i:s') . \" ===\\n\";\r\n+// $debugLog = \"=== Nouveau test à \" . date('Y-m-d H:i:s') . \" ===\\n\";\r\n \r\n // Charger PHPMailer\r\n use PHPMailer\\PHPMailer\\PHPMailer;\r\n use PHPMailer\\PHPMailer\\Exception;\r\n@@ -27,9 +27,9 @@\n $email = $_POST['email'] ?? '';\r\n $subject = $_POST['subject'] ?? '';\r\n $message = $_POST['message'] ?? '';\r\n \r\n-$debugLog .= \"Données reçues:\\nPrénom: $firstName\\nNom: $lastName\\nEmail: $email\\nSujet: $subject\\nMessage:\\n$message\\n\\n\";\r\n+// $debugLog .= \"Données reçues:\\nPrénom: $firstName\\nNom: $lastName\\nEmail: $email\\nSujet: $subject\\nMessage:\\n$message\\n\\n\";\r\n \r\n $mail_body = \"Nom: $firstName $lastName\\n\";\r\n $mail_body .= \"Email: $email\\n\\n\";\r\n $mail_body .= \"Message:\\n$message\";\r\n@@ -54,19 +54,19 @@\n     $mail->isHTML(false);\r\n     $mail->Subject = \"Nouveau message de $firstName $lastName - Sujet: $subject\";\r\n     $mail->Body = $mail_body;\r\n \r\n-    $debugLog .= \"Tentative d'envoi du mail...\\n\";\r\n+    // $debugLog .= \"Tentative d'envoi du mail...\\n\";\r\n \r\n     // Envoi\r\n     $mail->send();\r\n     echo 'success';\r\n-    $debugLog .= \"Mail envoyé avec succès.\\n\";\r\n+    // $debugLog .= \"Mail envoyé avec succès.\\n\";\r\n \r\n } catch (Exception $e) {\r\n     echo \"Erreur lors de l'envoi: {$mail->ErrorInfo}\";\r\n-    $debugLog .= \"Erreur lors de l'envoi:\\n\" . $mail->ErrorInfo . \"\\n\";\r\n+    // $debugLog .= \"Erreur lors de l'envoi:\\n\" . $mail->ErrorInfo . \"\\n\";\r\n }\r\n \r\n // Enregistrer tout ce qui s'est passé\r\n-file_put_contents('debug.txt', $debugLog . \"\\n\\n\", FILE_APPEND);\r\n+// file_put_contents('debug.txt', $debugLog . \"\\n\\n\", FILE_APPEND);\r\n ?>\n\\ No newline at end of file\n"
                }
            ],
            "date": 1745916884664,
            "name": "Commit-0",
            "content": "<?php\r\nerror_reporting(E_ALL);\r\nini_set('display_errors', 1);\r\nheader('Content-Type: text/plain'); // pour que le fetch lise le texte brut\r\n\r\n// Récupérer les données envoyées depuis le formulaire\r\n$firstName = $_POST['firstName'] ?? '';\r\n$lastName = $_POST['lastName'] ?? '';\r\n$email = $_POST['email'] ?? '';\r\n$subject = $_POST['subject'] ?? '';\r\n$message = $_POST['message'] ?? '';\r\necho \"Données reçues:\\n\";\r\necho \"Prénom: $firstName\\n\";\r\necho \"Nom: $lastName\\n\";\r\necho \"Email: $email\\n\";\r\necho \"Sujet: $subject\\n\";\r\necho \"Message: $message\\n\\n\";\r\n\r\n// Adresse de destination\r\n$to = 'contact@lys-and-co.com';\r\n\r\n// Sujet du mail\r\n$mail_subject = \"Nouveau message de $firstName $lastName - Sujet: $subject\";\r\n\r\n// Corps du mail\r\n$mail_body = \"Nom: $firstName $lastName\\n\";\r\n$mail_body .= \"Email: $email\\n\\n\";\r\n$mail_body .= \"Message:\\n$message\";\r\n\r\n// Headers (important pour bien recevoir)\r\n$headers = \"From: $email\\r\\n\";\r\n$headers .= \"Reply-To: $email\\r\\n\";\r\n\r\n// Envoyer l'email\r\nif (mail($to, $mail_subject, $mail_body, $headers)) {\r\n    echo 'success';\r\n} else {\r\n    echo \"Erreur lors de l'envoi du mail.\\n\";\r\n    echo \"Sujet : $mail_subject\\n\";\r\n    echo \"Destinataire : $to\\n\";\r\n    echo \"Headers : $headers\\n\";\r\n    echo \"Corps : $mail_body\\n\";\r\n    echo \"error\";\r\n}\r\n?>\r\n"
        }
    ]
}