{
    "sourceFile": "src/components/domiciliation/DomiciliationPricing.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1748540606753,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1748540661394,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -158,9 +158,9 @@\n                 Je m'engage pour plus de 6 mois\r\n               </label>\r\n             </div>\r\n \r\n-            <Button\r\n+            {/* <Button\r\n               className=\"w-full flex items-center justify-center bg-lysco-turquoise hover:bg-opacity-90\"\r\n               onClick={() =>\r\n                 handleAddToCart({\r\n                   id: engagementAuto\r\n@@ -171,9 +171,32 @@\n                 })\r\n               }\r\n             >\r\n               Ajouter au panier\r\n-            </Button>\r\n+            </Button> */}\r\n+            {session ? (\r\n+              <Button\r\n+                className=\"w-full flex items-center justify-center bg-lysco-turquoise hover:bg-opacity-90\"\r\n+                onClick={() =>\r\n+                  handleAddToCart({\r\n+                    id: engagementAuto\r\n+                      ? 'domiciliation-mensuel-auto-entreprise-reduit'\r\n+                      : 'domiciliation-mensuel-auto-entrepreneur-normal',\r\n+                    title: 'Domiciliation Mensuelle - Auto Entrepreneur',\r\n+                    price: engagementAuto ? '12,00' : '24,00'\r\n+                  })\r\n+                }\r\n+              >\r\n+                Ajouter au panier\r\n+              </Button>\r\n+            ) : (\r\n+              <Button\r\n+                className=\"w-full flex items-center justify-center bg-gray-400\"\r\n+                onClick={() => window.location.href = \"/login\"}\r\n+              >\r\n+                Se connecter pour ajouter au panier\r\n+              </Button>\r\n+            )}\r\n           </div>\r\n         </CardContent>\r\n       </Card>\r\n \r\n@@ -189,9 +212,9 @@\n             </p>\r\n             <p className=\"text-sm text-gray-600\">\r\n               Tarif spécial pour les associations.\r\n             </p>\r\n-            <Button\r\n+            {/* <Button\r\n               className=\"w-full flex items-center justify-center bg-lysco-turquoise hover:bg-opacity-90\"\r\n               onClick={() =>\r\n                 handleAddToCart({\r\n                   id: \"domiciliation-mensuel-association\",\r\n@@ -200,9 +223,30 @@\n                 })\r\n               }\r\n             >\r\n               Ajouter au panier\r\n-            </Button>\r\n+            </Button> */}\r\n+            {session ? (\r\n+              <Button\r\n+                className=\"w-full flex items-center justify-center bg-lysco-turquoise hover:bg-opacity-90\"\r\n+                onClick={() =>\r\n+                  handleAddToCart({\r\n+                    id: 'domiciliation-mensuel-association',\r\n+                    title: 'Domiciliation Mensuelle - Association',\r\n+                    price: '15,00'\r\n+                  })\r\n+                }\r\n+              >\r\n+                Ajouter au panier\r\n+              </Button>\r\n+            ) : (\r\n+              <Button\r\n+                className=\"w-full flex items-center justify-center bg-gray-400\"\r\n+                onClick={() => window.location.href = \"/login\"}\r\n+              >\r\n+                Se connecter pour ajouter au panier\r\n+              </Button>\r\n+            )}\r\n           </div>\r\n         </CardContent>\r\n       </Card>\r\n     </div>\r\n"
                },
                {
                    "date": 1748863145111,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -115,9 +115,9 @@\n               <Button\r\n                 className=\"w-full flex items-center justify-center bg-gray-400\"\r\n                 onClick={() => (window.location.href = \"/login\")}\r\n               >\r\n-                Se connecter pour ajouter au panier\r\n+                Connectez-vous\r\n               </Button>\r\n             )}\r\n           </div>\r\n         </CardContent>\r\n@@ -192,9 +192,9 @@\n               <Button\r\n                 className=\"w-full flex items-center justify-center bg-gray-400\"\r\n                 onClick={() => (window.location.href = \"/login\")}\r\n               >\r\n-                Se connecter pour ajouter au panier\r\n+                Connectez-vous\r\n               </Button>\r\n             )}\r\n           </div>\r\n         </CardContent>\r\n@@ -242,9 +242,9 @@\n               <Button\r\n                 className=\"w-full flex items-center justify-center bg-gray-400\"\r\n                 onClick={() => (window.location.href = \"/login\")}\r\n               >\r\n-                Se connecter pour ajouter au panier\r\n+                Connectez-vous\r\n               </Button>\r\n             )}\r\n           </div>\r\n         </CardContent>\r\n"
                }
            ],
            "date": 1748540606753,
            "name": "Commit-0",
            "content": "import React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { useCart } from \"@/components/cart/CartContext\";\r\nimport { useToast } from \"@/hooks/use-toast\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { Session } from \"@supabase/supabase-js\";\r\n\r\nconst DomiciliationPricing = () => {\r\n  const { addItem } = useCart();\r\n  const { toast } = useToast();\r\n\r\n  const [engagementSociete, setEngagementSociete] = useState(false);\r\n  const [engagementAuto, setEngagementAuto] = useState(false);\r\n  const [session, setSession] = useState<Session | null>(null);\r\nuseEffect(() => {\r\n    const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => setSession(session));\r\n    supabase.auth.getSession().then(({ data: { session } }) => setSession(session));\r\n    return () => subscription.unsubscribe();\r\n  }, []);\r\n\r\n  const handleAddToCart = (offer: {id: string, title: string, price: string}) => {\r\n    addItem({\r\n      id: offer.id,\r\n      title: offer.title,\r\n      price: parseFloat(offer.price.replace(',', '.')),\r\n      quantity: 1\r\n    });\r\n\r\n    toast({\r\n      title: \"Produit ajouté au panier\",\r\n      description: `${offer.title} a été ajouté à votre panier.`,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"grid gap-6 grid-cols-1 md:grid-cols-3\">\r\n      {/* Société */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Sociétés - Artisans - Commerçants</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <p className=\"text-3xl font-bold\">\r\n              {engagementSociete ? '18€' : '36€'}\r\n              <span className=\"text-base font-normal\">/mois</span>\r\n            </p>\r\n            <p className=\"text-sm text-gray-600\">\r\n              Pour un engagement de plus de 6 mois, bénéficiez de 50% de réduction sur votre premier trimestre.\r\n            </p>\r\n            {engagementSociete && (\r\n              <p className=\"font-medium text-green-600\">Soit 18€ vos 3 premiers mois !</p>\r\n            )}\r\n            <div className=\"flex items-center gap-2\">\r\n              <Checkbox\r\n                id=\"engagementSociete\"\r\n                checked={engagementSociete}\r\n                onCheckedChange={checked => setEngagementSociete(checked === true)}\r\n              />\r\n              <label htmlFor=\"engagementSociete\" className=\"text-sm cursor-pointer\">\r\n                Je m'engage pour plus de 6 mois\r\n              </label>\r\n            </div>\r\n\r\n            {/* <Button\r\n              className=\"w-full flex items-center justify-center bg-lysco-turquoise hover:bg-opacity-90\"\r\n              onClick={() =>\r\n                handleAddToCart({\r\n                  id: engagementSociete\r\n                    ? 'domiciliation-mensuel-societe-reduit'\r\n                    : 'domiciliation-mensuel-societe-normal',\r\n                  title: 'Domiciliation Mensuelle - Société',\r\n                  price: engagementSociete ? '18,00' : '36,00'\r\n                })\r\n              }\r\n            >\r\n              Ajouter au panier\r\n            </Button> */}\r\n            {session ? (\r\n              <Button\r\n                className=\"w-full flex items-center justify-center bg-lysco-turquoise hover:bg-opacity-90\"\r\n                onClick={() =>\r\n                  handleAddToCart({\r\n                    id: engagementSociete\r\n                      ? 'domiciliation-mensuel-societe-reduit'\r\n                      : 'domiciliation-mensuel-societe-normal',\r\n                    title: 'Domiciliation Mensuelle - Société',\r\n                    price: engagementSociete ? '18,00' : '36,00'\r\n                  })\r\n                }\r\n              >\r\n                Ajouter au panier\r\n              </Button>\r\n            ) : (\r\n              <Button\r\n                className=\"w-full flex items-center justify-center bg-gray-400\"\r\n                onClick={() => window.location.href = \"/login\"}\r\n              >\r\n                Se connecter pour ajouter au panier\r\n              </Button>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Auto-entrepreneur */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Auto-Entrepreneurs</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <p className=\"text-3xl font-bold\">\r\n              {engagementAuto ? '12€' : '24€'}\r\n              <span className=\"text-base font-normal\">/mois</span>\r\n            </p>\r\n            <p className=\"text-sm text-gray-600\">\r\n              Pour un engagement de plus de 6 mois, bénéficiez de 50% de réduction sur votre premier trimestre.\r\n            </p>\r\n            {engagementAuto && (\r\n              <p className=\"font-medium text-green-600\">Soit 12€ vos 3 premiers mois !</p>\r\n            )}\r\n            <div className=\"flex items-center gap-2\">\r\n              <Checkbox\r\n                id=\"engagementAuto\"\r\n                checked={engagementAuto}\r\n                onCheckedChange={checked => setEngagementAuto(checked === true)}\r\n              />\r\n              <label htmlFor=\"engagementAuto\" className=\"text-sm cursor-pointer\">\r\n                Je m'engage pour plus de 6 mois\r\n              </label>\r\n            </div>\r\n\r\n            <Button\r\n              className=\"w-full flex items-center justify-center bg-lysco-turquoise hover:bg-opacity-90\"\r\n              onClick={() =>\r\n                handleAddToCart({\r\n                  id: engagementAuto\r\n                    ? 'domiciliation-mensuel-auto-entreprise-reduit'\r\n                    : 'domiciliation-mensuel-auto-entrepreneur-normal',\r\n                  title: 'Domiciliation Mensuelle - Auto Entrepreneur',\r\n                  price: engagementAuto ? '12,00' : '24,00'\r\n                })\r\n              }\r\n            >\r\n              Ajouter au panier\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Associations */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Associations</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <p className=\"text-3xl font-bold\">15€<span className=\"text-base font-normal\">/mois</span></p>\r\n            <p className=\"text-sm text-gray-600\">Tarif spécial pour les associations.</p>\r\n            <Button\r\n              className=\"w-full flex items-center justify-center bg-lysco-turquoise hover:bg-opacity-90\"\r\n              onClick={() =>\r\n                handleAddToCart({\r\n                  id: 'domiciliation-mensuel-association',\r\n                  title: 'Domiciliation Mensuelle - Association',\r\n                  price: '15,00'\r\n                })\r\n              }\r\n            >\r\n              Ajouter au panier\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DomiciliationPricing;\r\n"
        }
    ]
}