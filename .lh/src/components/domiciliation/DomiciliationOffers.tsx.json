{
    "sourceFile": "src/components/domiciliation/DomiciliationOffers.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1745482350631,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1745482765226,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n+\r\n import React from 'react';\r\n import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\n import { Button } from '@/components/ui/button';\r\n import { ShoppingCart } from 'lucide-react';\r\n-import { useCart } from '@/components/cart/CartContext';\r\n \r\n interface OfferProps {\r\n   title: string;\r\n   price: string;\r\n@@ -44,10 +44,8 @@\n   },\r\n ];\r\n \r\n const DomiciliationOffers = () => {\r\n-  const { addToCart } = useCart();\r\n-\r\n   return (\r\n     <div className=\"py-12\">\r\n       <div className=\"container mx-auto px-4\">\r\n         <div className=\"text-center mb-8\">\r\n@@ -72,12 +70,9 @@\n                     <p className=\"text-lg line-through text-gray-500\">{offer.originalPrice} €</p>\r\n                   )}\r\n                   <p className=\"text-2xl font-semibold text-lysco-turquoise\">{offer.price} €</p>\r\n                 </div>\r\n-                <Button\r\n-                  className=\"mt-4 w-full flex items-center justify-center gap-2\"\r\n-                  onClick={() => addToCart({ id: offer.id, title: offer.title, price: parseFloat(offer.price) })}\r\n-                >\r\n+                <Button className=\"mt-4 w-full flex items-center justify-center gap-2\" onClick={() => addToCart(service)}>\r\n                   <ShoppingCart className=\"h-4 w-4\" />\r\n                   Ajouter au panier\r\n                 </Button>\r\n               </CardContent>\r\n"
                },
                {
                    "date": 1748540189990,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,10 +5,16 @@\n import { ShoppingCart } from 'lucide-react';\r\n import { useCart } from \"@/components/cart/CartContext\";\r\n import { Link } from 'react-router-dom';\r\n import { useToast } from \"@/hooks/use-toast\";\r\n+import { Session } from \"@supabase/supabase-js\";\r\n+import { useEffect, useState } from \"react\";\r\n+import { supabase } from \"@/integrations/supabase/client\";\r\n \r\n \r\n+\r\n+\r\n+\r\n interface OfferProps {\r\n   id: string;\r\n   title: string;\r\n   price: string;\r\n@@ -64,9 +70,16 @@\n \r\n const DomiciliationOffers = () => {\r\n   const { addItem } = useCart();\r\n   const { toast } = useToast();\r\n+  const [session, setSession] = useState<Session | null>(null);\r\n \r\n+  useEffect(() => {\r\n+    const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => setSession(session));\r\n+    supabase.auth.getSession().then(({ data: { session } }) => setSession(session));\r\n+    return () => subscription.unsubscribe();\r\n+  }, []);\r\n+\r\n   const handleAddToCart = (offer: OfferProps) => {\r\n     addItem({\r\n       id: offer.id,\r\n       title: offer.title,\r\n@@ -110,15 +123,31 @@\n                   <p className=\"text-2xl font-semibold text-lysco-turquoise\">{offer.price} €</p>\r\n                 </div>\r\n                 \r\n                 <div className=\"flex flex-col space-y-2 mt-4\">\r\n-                  <Button\r\n+                  {/* <Button\r\n                     className=\"w-full flex items-center justify-center gap-2 bg-lysco-turquoise hover:bg-opacity-90\"\r\n                     onClick={() => handleAddToCart(offer)}\r\n                   >\r\n                     <ShoppingCart className=\"h-4 w-4\" />\r\n                     Ajouter au panier\r\n-                  </Button>\r\n+                  </Button> */}\r\n+                  {session ? (\r\n+                    <Button\r\n+                      className=\"w-full flex items-center justify-center gap-2 bg-lysco-turquoise hover:bg-opacity-90\"\r\n+                      onClick={() => handleAddToCart(offer)}\r\n+                    >\r\n+                      <ShoppingCart className=\"h-4 w-4\" />\r\n+                      Ajouter au panier\r\n+                    </Button>\r\n+                  ) : (\r\n+                    <Button\r\n+                      className=\"w-full flex items-center justify-center gap-2 bg-gray-400\"\r\n+                      onClick={() => window.location.href = \"/login\"}\r\n+                    >\r\n+                      Se connecter pour ajouter au panier\r\n+                    </Button>\r\n+                  )}\r\n                   <Link to={offer.link} className=\"w-full\">\r\n                     <Button variant=\"outline\" className=\"w-full\">\r\n                       Voir les détails\r\n                     </Button>\r\n"
                },
                {
                    "date": 1748863137110,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -156,9 +156,9 @@\n                     <Button\r\n                       className=\"w-full flex items-center justify-center gap-2 bg-gray-400\"\r\n                       onClick={() => (window.location.href = \"/login\")}\r\n                     >\r\n-                      Se connecter pour ajouter au panier\r\n+                      Connectez-vous\r\n                     </Button>\r\n                   )}\r\n                   <Link to={offer.link} className=\"w-full\">\r\n                     <Button variant=\"outline\" className=\"w-full\">\r\n"
                }
            ],
            "date": 1745482350631,
            "name": "Commit-0",
            "content": "import React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { ShoppingCart } from 'lucide-react';\r\nimport { useCart } from '@/components/cart/CartContext';\r\n\r\ninterface OfferProps {\r\n  title: string;\r\n  price: string;\r\n  originalPrice?: string;\r\n  isPromo?: boolean;\r\n}\r\n\r\nconst offers: OfferProps[] = [\r\n  {\r\n    title: 'Domiciliation 1 an – Entreprise',\r\n    price: '361,80',\r\n    originalPrice: '432,00',\r\n    isPromo: true,\r\n  },\r\n  {\r\n    title: 'Domiciliation 3 mois – Entreprise',\r\n    price: '108,00',\r\n  },\r\n  {\r\n    title: 'Domiciliation 3 mois – Micro Entreprise',\r\n    price: '72,00',\r\n  },\r\n  {\r\n    title: 'Domiciliation 6 mois – Entreprise',\r\n    price: '162,00',\r\n    originalPrice: '216,00',\r\n    isPromo: true,\r\n  },\r\n  {\r\n    title: 'Domiciliation 6 mois – Micro Entreprise',\r\n    price: '108,00',\r\n    originalPrice: '144,00',\r\n    isPromo: true,\r\n  },\r\n  {\r\n    title: 'Pack domicilié',\r\n    price: '1514,00',\r\n  },\r\n];\r\n\r\nconst DomiciliationOffers = () => {\r\n  const { addToCart } = useCart();\r\n\r\n  return (\r\n    <div className=\"py-12\">\r\n      <div className=\"container mx-auto px-4\">\r\n        <div className=\"text-center mb-8\">\r\n          <h2 className=\"text-3xl font-bold mb-4\">Nos offres de domiciliation</h2>\r\n          <p className=\"text-gray-600\">6 résultats affichés</p>\r\n          <p className=\"text-sm text-gray-500\">Tri par défaut</p>\r\n        </div>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n          {offers.map((offer, index) => (\r\n            <Card key={index} className=\"flex flex-col\">\r\n              <CardHeader>\r\n                {offer.isPromo && (\r\n                  <div className=\"inline-block bg-red-100 text-red-600 px-3 py-1 rounded-full text-sm font-medium mb-2\">\r\n                    Promo !\r\n                  </div>\r\n                )}\r\n                <CardTitle className=\"text-xl\">{offer.title}</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"flex-grow flex flex-col justify-between\">\r\n                <div className=\"space-y-2\">\r\n                  {offer.isPromo && offer.originalPrice && (\r\n                    <p className=\"text-lg line-through text-gray-500\">{offer.originalPrice} €</p>\r\n                  )}\r\n                  <p className=\"text-2xl font-semibold text-lysco-turquoise\">{offer.price} €</p>\r\n                </div>\r\n                <Button\r\n                  className=\"mt-4 w-full flex items-center justify-center gap-2\"\r\n                  onClick={() => addToCart({ id: offer.id, title: offer.title, price: parseFloat(offer.price) })}\r\n                >\r\n                  <ShoppingCart className=\"h-4 w-4\" />\r\n                  Ajouter au panier\r\n                </Button>\r\n              </CardContent>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DomiciliationOffers;\r\n"
        }
    ]
}