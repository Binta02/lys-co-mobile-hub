{
    "sourceFile": "src/pages/domiciliation/Domiciliation3MoisMicroEntreprise.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1748541354818,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1748544229275,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,8 +19,9 @@\n import { supabase } from \"@/integrations/supabase/client\";\r\n import ReviewForm from \"@/components/services/ReviewForm\";\r\n import ReviewsList from \"@/components/services/ReviewsList\";\r\n import { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\n+import RelatedProducts from \"@/components/services/RelatedProducts\";\r\n \r\n const Domiciliation3MoisMicroEntreprise = () => {\r\n   const { addItem } = useCart();\r\n   const { toast } = useToast();\r\n@@ -257,9 +258,10 @@\n                 <TabsTrigger value=\"faq\">FAQ</TabsTrigger>\r\n               </TabsList>\r\n \r\n               <TabsContent value=\"description\">\r\n-                <ProductDescription />\r\n+<ProductDescription />\r\n+          <RelatedProducts currentId=\"domiciliation-3mois-entreprise\" currentCategory=\"domiciliation\" />\r\n               </TabsContent>\r\n \r\n               <TabsContent value=\"avis\">\r\n                 <div className=\"space-y-8 py-4\">\r\n"
                },
                {
                    "date": 1748550216484,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -209,9 +209,9 @@\n                     Se connecter pour ajouter au panier\r\n                   </Button>\r\n                 )}\r\n                 <Link to=\"/demande-devis\">\r\n-                  <Button variant=\"outline\">Demander un devis</Button>\r\n+                  <Button variant=\"outline\">Devis</Button>\r\n                 </Link>\r\n               </div>\r\n             </div>\r\n \r\n"
                }
            ],
            "date": 1748541354818,
            "name": "Commit-0",
            "content": "import { Session } from \"@supabase/supabase-js\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport Navbar from '@/components/Navbar';\r\nimport Footer from '@/components/Footer';\r\nimport { Button } from '@/components/ui/button';\r\nimport { ShoppingCart, ChevronLeft, Star } from 'lucide-react';\r\nimport { Link } from 'react-router-dom';\r\nimport { useCart } from \"@/components/cart/CartContext\";\r\nimport { useToast } from \"@/hooks/use-toast\";\r\nimport { Toaster } from \"@/components/ui/toaster\";\r\nimport { Breadcrumb, BreadcrumbItem, BreadcrumbLink, BreadcrumbList, BreadcrumbSeparator } from \"@/components/ui/breadcrumb\";\r\nimport ProductDescription from '@/components/services/ProductDescription';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport ReviewForm from '@/components/services/ReviewForm';\r\nimport ReviewsList from '@/components/services/ReviewsList';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\n\r\nconst Domiciliation3MoisMicroEntreprise = () => {\r\n  const { addItem } = useCart();\r\n  const { toast } = useToast();\r\n  const [reviews, setReviews] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [session, setSession] = useState(null);\r\n  const [currentUserId, setCurrentUserId] = useState(null);\r\n  const productName = 'Domiciliation 3 mois – Micro Entreprise';\r\n  const productId = 'domiciliation-3mois-micro';\r\n  \r\n  useEffect(() => {\r\n    const fetchReviews = async () => {\r\n      setIsLoading(true);\r\n      const { data, error } = await supabase\r\n        .from('reviews')\r\n        .select('*')\r\n        .eq('product_name', productName)\r\n        .order('created_at', { ascending: false });\r\n      \r\n      if (error) {\r\n        console.error('Error fetching reviews:', error);\r\n      } else {\r\n        setReviews(data || []);\r\n      }\r\n      setIsLoading(false);\r\n    };\r\n\r\n    fetchReviews();\r\n\r\n    // Check auth state\r\n    supabase.auth.getSession().then(({ data: { session } }) => {\r\n      setSession(session);\r\n      setCurrentUserId(session?.user?.id || null);\r\n    });\r\n\r\n    const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {\r\n      setSession(session);\r\n      setCurrentUserId(session?.user?.id || null);\r\n    });\r\n\r\n    return () => subscription.unsubscribe();\r\n  }, []);\r\n\r\n  const handleAddToCart = () => {\r\n    addItem({\r\n      id: 'domiciliation-3mois-micro',\r\n      title: 'Domiciliation 3 mois – Micro Entreprise',\r\n      price: 72.00,\r\n      quantity: 1\r\n    });\r\n\r\n    toast({\r\n      title: \"Produit ajouté au panier\",\r\n      description: \"Domiciliation 3 mois – Micro Entreprise a été ajouté à votre panier.\",\r\n    });\r\n  };\r\n\r\n  const handleReviewSubmitted = () => {\r\n    // Recharger les avis après l'ajout d'un nouvel avis\r\n    const fetchReviews = async () => {\r\n      const { data, error } = await supabase\r\n        .from('reviews')\r\n        .select('*')\r\n        .eq('product_name', productName)\r\n        .order('created_at', { ascending: false });\r\n      \r\n      if (!error) {\r\n        setReviews(data || []);\r\n      }\r\n    };\r\n\r\n    fetchReviews();\r\n  };\r\n\r\n  // Fonction pour supprimer un avis\r\n  const handleDeleteReview = async (reviewId) => {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('reviews')\r\n        .delete()\r\n        .eq('id', reviewId)\r\n        .eq('user_id', currentUserId); // S'assurer que l'utilisateur ne peut supprimer que ses propres avis\r\n      \r\n      if (error) throw error;\r\n      \r\n      toast({\r\n        title: \"Avis supprimé\",\r\n        description: \"Votre avis a été supprimé avec succès\",\r\n      });\r\n      \r\n      // Recharger les avis après la suppression\r\n      handleReviewSubmitted();\r\n    } catch (error) {\r\n      console.error('Erreur lors de la suppression de l\\'avis:', error);\r\n      toast({\r\n        title: \"Erreur\",\r\n        description: \"Impossible de supprimer l'avis\",\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex flex-col\">\r\n      <Navbar />\r\n      <main className=\"flex-1 py-8\">\r\n        <div className=\"container mx-auto px-4\">\r\n          <Breadcrumb className=\"mb-6\">\r\n            <BreadcrumbList>\r\n              <BreadcrumbItem>\r\n                <BreadcrumbLink to=\"/\">Accueil</BreadcrumbLink>\r\n              </BreadcrumbItem>\r\n              <BreadcrumbSeparator />\r\n              <BreadcrumbItem>\r\n                <BreadcrumbLink to=\"/domiciliation\">Domiciliation</BreadcrumbLink>\r\n              </BreadcrumbItem>\r\n              <BreadcrumbSeparator />\r\n              <BreadcrumbItem>\r\n                <BreadcrumbLink to=\"\">Domiciliation 3 mois – Micro Entreprise</BreadcrumbLink>\r\n              </BreadcrumbItem>\r\n            </BreadcrumbList>\r\n          </Breadcrumb>\r\n\r\n          <div className=\"mb-8\">\r\n            <Link to=\"/domiciliation\" className=\"flex items-center text-lysco-turquoise hover:underline\">\r\n              <ChevronLeft className=\"h-4 w-4 mr-1\" /> Retour aux services de domiciliation\r\n            </Link>\r\n          </div>\r\n\r\n          <div className=\"grid md:grid-cols-2 gap-8\">\r\n            <div className=\"space-y-6\">\r\n              <h1 className=\"text-3xl font-bold\">Domiciliation 3 mois – Micro Entreprise</h1>\r\n              <div>\r\n                <span className=\"text-2xl font-semibold text-lysco-turquoise\">72,00 €</span>\r\n                <p className=\"text-sm text-gray-500\">Hors taxes</p>\r\n              </div>\r\n\r\n              <div className=\"prose max-w-none\">\r\n                <p>Notre service de domiciliation pour micro-entreprise pendant 3 mois offre une adresse professionnelle prestigieuse pour les entrepreneurs individuels et les petites entreprises. Avec notre service, vous bénéficiez d'une adresse commerciale pour votre activité, ainsi que de la réception et de la gestion de votre courrier. Profitez de tous les avantages d'une adresse professionnelle sans les coûts et les engagements à long terme.</p>\r\n              </div>\r\n\r\n              <div className=\"flex space-x-4\">\r\n                {/* <Button \r\n                  className=\"bg-lysco-turquoise hover:bg-opacity-90 flex items-center\"\r\n                  onClick={handleAddToCart}\r\n                >\r\n                  <ShoppingCart className=\"h-4 w-4 mr-2\" /> Ajouter au panier\r\n                </Button> */}\r\n                {session ? (\r\n    <Button \r\n      className=\"bg-lysco-turquoise hover:bg-opacity-90 flex items-center\"\r\n      onClick={handleAddToCart}\r\n    >\r\n      <ShoppingCart className=\"h-4 w-4 mr-2\" /> Ajouter au panier\r\n    </Button>\r\n  ) : (\r\n    <Button\r\n      className=\"bg-gray-400 flex items-center\"\r\n      onClick={() => (window.location.href = \"/login\")}\r\n    >\r\n      Se connecter pour ajouter au panier\r\n    </Button>\r\n  )}\r\n                <Link to=\"/demande-devis\">\r\n                  <Button variant=\"outline\">\r\n                    Demander un devis\r\n                  </Button>\r\n                </Link>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-gray-100 rounded-lg p-6 space-y-4\">\r\n              <h2 className=\"text-xl font-semibold\">Description</h2>\r\n              <div className=\"prose\">\r\n                <p>Notre service de domiciliation pour micro-entreprise pendant 3 mois est conçu pour répondre aux besoins spécifiques des entrepreneurs individuels et des petites entreprises qui recherchent une adresse professionnelle pour leur activité.</p>\r\n                <p>Avec notre service, vous bénéficiez d'une adresse prestigieuse pour votre micro-entreprise pendant une période de 3 mois. Cette adresse peut être utilisée sur vos documents officiels, vos cartes de visite et votre correspondance professionnelle, vous permettant de présenter une image professionnelle à vos clients et partenaires.</p>\r\n                <p>En plus de l'adresse commerciale, notre service comprend la réception et la gestion de votre courrier pendant la période de domiciliation. Nous recevons votre courrier en votre nom et pouvons vous le transférer selon vos instructions.</p>\r\n                <p>Profitez dès maintenant de notre service de domiciliation pour micro-entreprise pendant 3 mois et donnez à votre activité une image professionnelle et crédible sans les coûts et les engagements à long terme.</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"mt-12\">\r\n            <Tabs defaultValue=\"description\" className=\"w-full\">\r\n              <TabsList className=\"grid w-full grid-cols-3\">\r\n                <TabsTrigger value=\"description\">Description complète</TabsTrigger>\r\n                <TabsTrigger value=\"avis\">Avis clients</TabsTrigger>\r\n                <TabsTrigger value=\"faq\">FAQ</TabsTrigger>\r\n              </TabsList>\r\n\r\n              <TabsContent value=\"description\">\r\n                <ProductDescription />\r\n              </TabsContent>\r\n\r\n              <TabsContent value=\"avis\">\r\n                <div className=\"space-y-8 py-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <h3 className=\"text-2xl font-semibold\">Avis clients</h3>\r\n                    <div className=\"flex items-center\">\r\n                      <div className=\"flex\">\r\n                        {[1, 2, 3, 4, 5].map((star) => (\r\n                          <Star \r\n                            key={star} \r\n                            className=\"h-5 w-5 text-yellow-400 fill-yellow-400\" \r\n                          />\r\n                        ))}\r\n                      </div>\r\n                      <span className=\"ml-2 text-sm text-gray-600\">\r\n                        {reviews.length} avis\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {reviews.length > 0 && (\r\n                    <ReviewsList \r\n                      reviews={reviews} \r\n                      isLoading={isLoading} \r\n                      currentUserId={currentUserId}\r\n                      onDeleteReview={handleDeleteReview}\r\n                    />\r\n                  )}\r\n\r\n                  {session ? (\r\n                    <ReviewForm \r\n                      productName={productName} \r\n                      productId={productId}\r\n                      onReviewSubmitted={handleReviewSubmitted}\r\n                    />\r\n                  ) : (\r\n                    <div className=\"text-center py-6 bg-gray-50 rounded-lg\">\r\n                      <p className=\"mb-4\">Connectez-vous pour laisser un avis</p>\r\n                      <Link to=\"/login\">\r\n                        <Button>Se connecter</Button>\r\n                      </Link>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </TabsContent>\r\n\r\n              <TabsContent value=\"faq\">\r\n                <div className=\"space-y-4 py-4\">\r\n                  <h3 className=\"text-2xl font-semibold\">Questions fréquentes</h3>\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n                      <h4 className=\"font-medium\">Qu'est-ce qu'une domiciliation d'entreprise ?</h4>\r\n                      <p className=\"text-gray-600 mt-2\">La domiciliation d'entreprise est un service qui permet à une entreprise d'établir son siège social à une adresse différente de celle de son dirigeant. C'est une solution idéale pour les entrepreneurs qui travaillent depuis leur domicile mais souhaitent avoir une adresse professionnelle.</p>\r\n                    </div>\r\n                    <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n                      <h4 className=\"font-medium\">Quels documents sont nécessaires pour une domiciliation ?</h4>\r\n                      <p className=\"text-gray-600 mt-2\">Pour une domiciliation, vous aurez besoin de votre pièce d'identité, d'un justificatif de domicile personnel, et des documents relatifs à votre entreprise (statuts, extrait Kbis si disponible). Nous vous guidons tout au long du processus.</p>\r\n                    </div>\r\n                    <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n                      <h4 className=\"font-medium\">Puis-je renouveler mon contrat après les 3 mois ?</h4>\r\n                      <p className=\"text-gray-600 mt-2\">Absolument, vous pouvez renouveler votre contrat après la période initiale de 3 mois. Nous proposons également des offres pour 6 mois ou 1 an avec des tarifs préférentiels pour les engagements plus longs.</p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </TabsContent>\r\n            </Tabs>\r\n          </div>\r\n        </div>\r\n      </main>\r\n      <Footer />\r\n      <Toaster />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Domiciliation3MoisMicroEntreprise;\r\n"
        }
    ]
}